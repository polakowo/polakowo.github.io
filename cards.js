cards = [{
    "img_url": "img/idt.svg",
    "title": "Design and development of a platform for analyzing digital transformation projects",
    "description": `
    <p>
        The primary goal of this project was to study the current and ongoing digital transformation of organizations.
        First, we identified crucial success and failure factors of digital transformation initiatives.
        We used data mining to determine their empirical significance and uncover hidden relationships.
        Second, we conducted a comprehensive network analysis designed to examine corporate collaboration on digital transformation activities.
        We also developed a software package in Python to decrease the barriers to performing the same analysis steps in the future.
        Finally, we designed and developed an extensible software prototype capable of collecting, analyzing and organizing information on digital transformation projects.
    </p>
    <p>
        The prototype was made specifically for the <a href="https://www.i17.in.tum.de/home/">Chair of Information Systems</a> at the Technical University in Munich.
    </p>
    `,
    "background": "repeating-radial-gradient(circle, #26687F, #26687F 10px, #286D84 10px, #286D84 20px)",
    "tags": ['Python', 'sklearn', 'NetworkX', 'NodeJS', 'JavaScript'],
    "pictures": [
        "img/pictures/idt1.png",
        "img/pictures/idt2.png",
        "img/pictures/idt3.png",
        "img/pictures/idt4.png",
        "img/pictures/idt5.png"
    ],
    "videos": [],
    "url": "",
    "section": "Master's Thesis"
}, {
    "img_url": "img/saphana.png",
    "title": "Detection of occupational fraud activity in ERP systems using SAP HANA",
    "description": `
    <p>
        The objective of this work was investigation of occupational fraud activity in P2P business data and implementation of a prototype
        for its detection - a comprehensive tool dedicated for fraud investigators and forensic accountants.
        We applied a red-flag based approach to detect fraudulent patterns once fraud prevention has failed.
        The prototype leverages the power of SAP HANA to process large volumes of ERP data blazingly fast.
        In addition to processing capabilities, the tool offers a web interface with a rich, customizable UI.
    </p>
    <p>
        The prototype was made in collaboration with <a href="https://www.i17.in.tum.de/en/research/projects/current-projects/sap-university-competence-center-ucc/">SAP UCC</a>.
    </p>
    `,
    "background": "repeating-linear-gradient(to bottom, #3168AB, #3168AB 10px, #336EB3 10px, #336EB3 20px)",
    "tags": ['SAP HANA', 'SAP ERP', 'SQLScript', 'XSJS', 'SAPUI5', 'JavaScript'],
    "pictures": [
        "img/pictures/hana1.png",
        "img/pictures/hana2.png",
        "img/pictures/hana3.png",
    ],
    "videos": [],
    "url": "",
    "section": "Bachelor's Thesis"
}, {
    "img_url": "img/zeissimt.png",
    "title": "Design and development of a mobile app for connecting Zeiss with its customers",
    "description": `
    <p>
        Zeiss IMT is an iOS application prototype which aims to facilitate the communication and interaction between Zeiss Metrology centers and their potential customers.
        The project life cycle was managed with Agile techniques (Scrum) and backed by communicating continuously to clients.
        The process included object-oriented modeling and system design as well as the realization of graphical UIs, usability testing, continuous integration and delivery.
        The responsibilities of mine also included server-side development and release management.
    </p>
    `,
    "background": "white",
    "tags": ['Swift', 'NodeJS'],
    "pictures": [],
    "videos": [{
        "video": "https://www.youtube.com/embed/8wqAjsUedyg",
        "img": "img/pictures/zeiss.png"
    }],
    "url": "",
    "section": "Corporate Project"
}, {
    "img_url": "img/oscarobber.png",
    "title": "Network and sentiment analysis applied on the IMDB database",
    "description": `
    <p>
        Performed a comprehensive analysis on IMDB dataset
    </p>
    `,
    "background": "#0B1A2D",
    "tags": ['Python', 'sklearn', 'NetworkX', 'NLTK'],
    "pictures": [],
    "videos": [],
    "url": "https://polakowo.github.io/oscarobber/",
    "section": "Capstone Project"
}, {
    "img_url": "img/gtd-analysis.png",
    "title": "Analysis of the most comprehensive open-source database on terrorist events",
    "description": "",
    "background": "repeating-linear-gradient(-45deg, #FDE457, #FDE457 20px, #FDDE4C 20px, #FDDE4C 40px)",
    "tags": ['Python', 'sklearn', 'JavaScript', 'D3.js'],
    "pictures": [],
    "videos": [],
    "url": "img/gtd-analysis.png",
    "section": "Capstone Project"
}, {
    "img_url": "img/datadocs.svg",
    "title": "Collaborative documentation platform for and from data scientists",
    "description": "",
    "background": "#659D7A",
    "tags": [],
    "pictures": [],
    "videos": [],
    "url": "",
    "section": "Open Source Project"
}, {
    "img_url": "img/cryptoz.svg",
    "title": "Package with visualization tools for tracking cryptocurrency markets",
    "description": "",
    "background": "#B7E5FC",
    "tags": [],
    "pictures": [],
    "videos": [],
    "url": "https://github.com/polakowo/cryptoz",
    "section": "Open Source Project"
}, {
    "img_url": "img/vector-bt.svg",
    "title": "Package for backtesting and trade optimization",
    "description": "",
    "background": "#FBD249",
    "tags": [],
    "pictures": [],
    "videos": [],
    "url": "https://github.com/polakowo/vector-bt",
    "section": "Open Source Project"
}, {
    "img_url": "img/amazon-reviews-sentiment-analysis.png",
    "title": "Sentiment analysis of Amazon product reviews",
    "description": "",
    "background": "#232F3D",
    "tags": ['fastai'],
    "pictures": [],
    "videos": [],
    "url": "https://github.com/polakowo/mlprojects/tree/master/amazon-reviews-sentiment-analysis",
    "section": "ML Project"
}, {
    "img_url": "img/1c-sales-prediction.png",
    "title": "Forecasting total sales for every product and store in the next month",
    "description": "",
    "background": "white",
    "tags": ['LGBM', 'CatBoost', 'Vowpal Wabbit', 'sklearn', 'fastai', 'stacking'],
    "pictures": [],
    "videos": [],
    "url": "https://github.com/polakowo/mlprojects/tree/master/1c-sales-prediction",
    "section": "ML Project"
}, {
    "img_url": "img/rossmann-sales-prediction.png",
    "title": "Forecasting daily Rossmann sales for up to six weeks in advance",
    "description": "",
    "background": "white",
    "tags": ['fastai'],
    "pictures": [],
    "videos": [],
    "url": "https://github.com/polakowo/mlprojects/tree/master/rossmann-sales-prediction",
    "section": "ML Project"
}, {
    "img_url": "img/credit-card-fraud-detection.png",
    "title": "Detecting fraudulent credit card transactions with anomaly detection",
    "description": "",
    "background": "#65A7CB",
    "tags": ['sklearn', 'PyTorch', 'fastai'],
    "pictures": [],
    "videos": [],
    "url": "https://github.com/polakowo/mlprojects/tree/master/credit-card-fraud-detection",
    "section": "ML Project"
}, {
    "img_url": "img/movielens-recommendation.jpg",
    "title": "Movie recommendation system using item-based collaborative filtering",
    "description": "",
    "background": "#EF6937",
    "tags": ['fastai'],
    "pictures": [],
    "videos": [],
    "url": "https://github.com/polakowo/mlprojects/tree/master/movielens-recommendation",
    "section": "ML Project"
}, {
    "img_url": "img/airbus-ship-segmentation.jpg",
    "title": "Detection and segmentation of ships in satellite images",
    "description": "",
    "background": "#223C75",
    "tags": ['fastai'],
    "pictures": [],
    "videos": [],
    "url": "https://github.com/polakowo/mlprojects/tree/master/airbus-ship-segmentation",
    "section": "ML Project"
}, {
    "img_url": "img/planet-amazon-classification.svg",
    "title": "Classification of satellite images for different atmospheric conditions and land cover and use",
    "description": "",
    "background": "#223C75",
    "tags": ['fastai'],
    "pictures": [],
    "videos": [],
    "url": "https://github.com/polakowo/mlprojects/tree/master/planet-amazon-classification",
    "section": "ML Project"
}]

const generate_card = (item, i) => $(`
    <div class="col-xs-12 col-sm-6 col-lg-4">
        <div class="card mb-4 box-shadow project" data-id="${i}">
            <table style="height: 225px; width: 100%;">
                <tbody>
                    <tr>
                        <td class="align-middle text-center" style="background: ${item.background};">
                            <img class="card-img-top" src="${item.img_url}">
                        </td>
                    </tr>
                </tbody>
            </table>
            <div class="card-body">
                <p class="card-text">${item.title}</p>
                <div class="d-flex justify-content-between align-items-center">
                    <small class="text-muted">${item.section}</small>
                </div>
            </div>
        </div>
    </div>
`)
const generate_details = (item, i) => $(`
    <div class="row">
        <div class="col-xs-12 col-lg-8 offset-lg-2">
            <div class="collapse" data-id="${i}">
                <div class="card card-body mb-5">
                    <div class="card-text">
                        <small>Description</small>
                        ${item.description}
                    </div>
                    ${item.tags.length > 0 ? `
                        <small>Tags</small>
                        <p class="card-text">${item.tags.map(tag => `<span class="badge badge-pill badge-light">${tag}</span>`).join(' ')}</p>` 
                    : ''}
                    ${item.pictures.length > 0 ? `
                        <small>Images</small>
                        <div class="container">
                            <div class="row">
                                ${item.pictures.map(path => (`
                                    <div class="col-xs-6 col-sm-4 col-lg-3 mt-2">
                                        <a href="${path}" data-toggle="lightbox" data-gallery="gallery">
                                            <img src="${path}" class="img-fluid img-thumbnail">
                                        </a>
                                    </div>`
                                )).join('')}
                            </div>
                        </div>` 
                    : ``}
                    ${item.videos.length > 0 ? `
                        <small>Videos</small>
                        <div class="container">
                            <div class="row">
                                ${item.videos.map(path => (`
                                    <div class="col-xs-6 col-sm-4 col-lg-3 mt-2">
                                        <a href="${path.video}" data-toggle="lightbox" data-gallery="gallery">
                                            <img src="${path.img}" class="img-fluid img-thumbnail">
                                        </a>
                                    </div>`
                                )).join('')}
                            </div>
                        </div>` 
                    : ``}
                    <div class="d-flex justify-content-between align-items-center">
                        <div class="btn-group">
                            ${item.url ? `<a href="${item.url}"target="_blank" role="button" 
                            class="btn btn-sm btn-outline-secondary">View</a>` : ``}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
`)

function collapse() {
    const id = $(this).data('id')
    const $details = $(`.collapse[data-id="${id}"]`)
    const shown = $details.hasClass('show')

    if ($('.collapse.show').length) {
        $('.collapse.show').on('hidden.bs.collapse', function () {
            $('.collapse').off('hidden.bs.collapse')
            if (!shown) {
                $details.collapse('show')
                $(`.project[data-id!="${id}"]`).css('opacity', 0.3)
            }
        })
        $('.collapse.show').collapse('hide')
        $('.project').css('opacity', 1.0)
    } else {
        $details.collapse('show')
        $(`.project[data-id!="${id}"]`).css('opacity', 0.3)
    }
}

function getBootstrapDeviceSize() {
    return $('#users-device-size').find('div:visible').last().data('id');
}

$(document).ready(function () {
    size = getBootstrapDeviceSize()
    console.log(size)
    everyth = null
    switch (size) {
        case 'xs':
            everyth = 1
            break
        case 'sm':
        case 'md':
            everyth = 2
            break
        case 'lg':
        case 'xl':
            everyth = 3
            break
    }
    let $currentRow = null;
    cards.forEach((item, i) => {
        if (i % everyth == 0) {
            const $container = $(`#projects-container`)
            $currentRow = $('<div class="row"></div>')
            $container.append($currentRow)
        }
        $currentRow.append(generate_card(item, i))
        $currentRow.parent().append(generate_details(item, i))
        $(`.project[data-id="${i}"]`).on("click", collapse);
    })
})

$(document).on('click', '[data-toggle="lightbox"]', function (event) {
    event.preventDefault();
    $(this).ekkoLightbox({
        alwaysShowClose: true,
        showArrows: false
    });
});